<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Employees</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/styles/employee-page.css" />
  </head>
  <body>
    <h1 class="title">Employee List</h1>
    <div class="container">
      <div class="employee-container">
        <% if (employees && employees.length > 0) { %>
          <table>
            <thead>
              <tr>
                <th>No.</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Job Title</th>
                <th>Email</th>
                <th>Extension</th>
                <th>Office Code</th>
                <th>Reports To</th>
                <th><input type="checkbox" name="" id=""></th>
              </tr>
            </thead>
            <tbody>
              <% employees.forEach(employee => { %>
                <tr>
                  <td><%= employee.employeeNumber %></td>
                  <td><%= employee.firstName %></td>
                  <td><%= employee.lastName %></td>
                  <td><%= employee.jobTitle %></td>
                  <td><%= employee.email %></td>
                  <td><%= employee.extension || 'N/A' %></td>
                  <td><%= employee.officeCode || 'N/A' %></td>
                  <td><%= employee.reportsTo || 'N/A' %></td>
                  <td><input type="checkbox" name="" id=""></td>
                </tr>
              <% }) %>
            </tbody>
          </table>
        <% } else { %>
          <div class="no-employees">No employees found.</div>
        <% } %>
        <div class="page-navigation">
          <p class="current-page">Page 1 / 3</p> 
          <div class="button-group">
            <button disabled>Delete</button>
            <button>Prev</button>
            <button>Next</button>
          </div>
        </div>
      </div>
      <form class="add-form" action="/add" method="POST">
        <h2 class="form-title">New Employee</h2>
        <div class="form-body">
          <div class="form-field">
            <label for="firstName">First Name</label>
            <input type="text" id="firstName" name="firstName" required>
          </div>
          <div class="form-field">
            <label for="lastName">Last Name</label>
            <input type="text" id="lastName" name="lastName" required>
          </div>
          <div class="form-field">
            <label for="jobTitle">Job Title</label>
            <input type="text" id="jobTitle" name="jobTitle" required>
          </div>
          <div class="form-field">
            <label for="email">Email</label>
            <input type="email" id="email" name="email" required>
          </div>
          <div class="form-field">
            <label for="extension">Extension</label>
            <input type="text" id="extension" name="extension">
          </div>
          <div class="form-field">
            <label for="officeCode">Office Code</label>
            <input type="text" id="officeCode" name="officeCode">
          </div>
          <div class="form-field">
            <label for="reportsTo">Reports To</label>
            <input type="number" id="reportsTo" name="reportsTo">
          </div>
        </div>
        <button type="submit" class="submit-button">Add Employee</button>
      </form>
    </div>
    <div class="edit-modal">
      <div class="modal-container">
        <div class="modal-header">
          <h3>Edit Employee</h3>
          <button class="close-btn">x</button>
        </div>
        <div class="modal-body">
          <form class="edit-form" action="/update" method="POST">
            <div class="form-body">
              <div class="form-field">
                <label for="firstName">First Name</label>
                <input type="text" id="firstName" name="firstName" required>
              </div>
              <div class="form-field">
                <label for="lastName">Last Name</label>
                <input type="text" id="lastName" name="lastName" required>
              </div>
              <div class="form-field">
                <label for="jobTitle">Job Title</label>
                <input type="text" id="jobTitle" name="jobTitle" required>
              </div>
              <div class="form-field">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" required>
              </div>
              <div class="form-field">
                <label for="extension">Extension</label>
                <input type="text" id="extension" name="extension">
              </div>
              <div class="form-field">
                <label for="officeCode">Office Code</label>
                <input type="text" id="officeCode" name="officeCode">
              </div>
              <div class="form-field">
                <label for="reportsTo">Reports To</label>
                <input type="number" id="reportsTo" name="reportsTo">
              </div>
            </div>
            <button type="submit" class="submit-button">Save</button>
          </form>
        </div>
      </div>
    </div>
  </body>

  <script>
    const rows = document.querySelectorAll('tbody tr');
    const modal = document.querySelector('.edit-modal');
    const closeBtn = modal.querySelector('.close-btn');
    const form = modal.querySelector('.edit-form');

    rows.forEach(row => {
      row.addEventListener('click', () => {
        const cells = row.querySelectorAll('td');

        form.querySelector('#firstName').value = cells[1].textContent;
        form.querySelector('#lastName').value = cells[2].textContent;
        form.querySelector('#jobTitle').value = cells[3].textContent;
        form.querySelector('#email').value = cells[4].textContent;
        form.querySelector('#extension').value = cells[5].textContent !== 'N/A' ? cells[5].textContent : '';
        form.querySelector('#officeCode').value = cells[6].textContent !== 'N/A' ? cells[6].textContent : '';
        form.querySelector('#reportsTo').value = cells[7].textContent !== 'N/A' ? cells[7].textContent : '';

        modal.classList.add("open");
      });
    });

    closeBtn.addEventListener('click', () => {
      modal.classList.remove("open");
    });

    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.classList.remove("open");
      }
    });
  </script>
</html>
